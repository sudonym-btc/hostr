services:
  cleanup:
    entrypoint: ['/bin/bash', '-c', 'echo "cleanup disabled by hostr override"; exit 0']

  # Expose anvil to nginx-proxy so the Flutter app can reach it via
  # https://anvil.hostr.development (TLS-terminated by nginx-proxy).
  # Without VIRTUAL_HOST + shared_network, nginx sends TLSV1_ALERT_UNRECOGNIZED_NAME.
  anvil:
    platform: ${DOCKER_DEFAULT_PLATFORM:-linux/arm64}
    environment:
      - VIRTUAL_HOST=anvil.${DOMAIN}
      - VIRTUAL_PORT=8545
    networks:
      - default
      - shared_network

  # Force Boltz service platform explicitly, but allow CI/host to override via
  # DOCKER_DEFAULT_PLATFORM (e.g. linux/amd64 on GitHub runners).
  # Falls back to linux/arm64 for Apple Silicon local development.
  boltz-backend:
    platform: ${DOCKER_DEFAULT_PLATFORM:-linux/arm64}

  boltz-backend-nginx:
    platform: ${DOCKER_DEFAULT_PLATFORM:-linux/arm64}

  boltz-client:
    platform: ${DOCKER_DEFAULT_PLATFORM:-linux/arm64}
