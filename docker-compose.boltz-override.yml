services:
  cleanup:
    entrypoint: ['/bin/bash', '-c', 'echo "cleanup disabled by hostr override"; exit 0']

  # Expose anvil to nginx-proxy so the Flutter app can reach it via
  # https://anvil.hostr.development (TLS-terminated by nginx-proxy).
  # Without VIRTUAL_HOST + shared_network, nginx sends TLSV1_ALERT_UNRECOGNIZED_NAME.
  anvil:
    platform: ${DOCKER_DEFAULT_PLATFORM:-linux/arm64}
    environment:
      - VIRTUAL_HOST=anvil.${DOMAIN}
      - VIRTUAL_PORT=8545
    networks:
      - default
      - shared_network

  # Force native arm64 platform for boltz images that don't declare one.
  # Without this, Docker may use a stale linux/amd64 layer from the local cache
  # which fails to start on Apple Silicon (and other arm64 hosts).
  boltz-backend:
    platform: linux/arm64

  boltz-backend-nginx:
    platform: linux/arm64

  boltz-client:
    platform: linux/arm64
