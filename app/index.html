<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="turbo-cache-control" content="no-cache" data-turbo-track="reload" data-track-token="3.6.0.792102597362">

    <!-- See retype.com -->
    <meta name="generator" content="Retype 3.6.0">

    <!-- Primary Meta Tags -->
    <title>App</title>
    <meta name="title" content="App">
    <meta name="description" content="codecov">

    <!-- Canonical -->
    <link rel="canonical" href="/app/">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="/app/">
    <meta property="og:title" content="App">
    <meta property="og:description" content="codecov">
    <meta property="og:image" content="https://codecov.io/gh/sudonym-btc/hostr/branch/main/graph/badge.svg?token=YOUR_TOKEN">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="/app/">
    <meta property="twitter:title" content="App">
    <meta property="twitter:description" content="codecov">
    <meta property="twitter:image" content="https://codecov.io/gh/sudonym-btc/hostr/branch/main/graph/badge.svg?token=YOUR_TOKEN">

    <script data-cfasync="false">(function () { var el = document.documentElement, m = localStorage.getItem("doc_theme"), wm = window.matchMedia; if (m === "dark" || (!m && wm && wm("(prefers-color-scheme: dark)").matches)) { el.classList.add("dark") } else { el.classList.remove("dark") } })();</script>

    <link href="../resources/css/retype.css?v=3.6.0.792102597362" rel="stylesheet">

    <script data-cfasync="false" src="../resources/js/config.js?v=3.6.0.792102597362" data-turbo-eval="false" defer></script>
    <script data-cfasync="false" src="../resources/js/retype.js?v=3.6.0" data-turbo-eval="false" defer></script>
    <script id="lunr-js" data-cfasync="false" src="../resources/js/lunr.js?v=3.6.0.792102597362" data-turbo-eval="false" defer></script>
    <script id="prism-js" data-cfasync="false" src="../resources/js/prism.js?v=3.6.0.792102597362" defer></script>
    <script id="mermaid-js" data-cfasync="false" src="../resources/js/mermaid.js?v=3.6.0" defer></script>
</head>
<body>
    <div id="docs-app" class="relative text-base antialiased text-gray-700 bg-white font-body dark:bg-dark-850 dark:text-dark-300">
        <div class="absolute bottom-0 left-0 bg-gray-100 dark:bg-dark-800" style="top: 5rem; right: 50%"></div>
    
        <header id="docs-site-header" class="sticky top-0 z-30 flex w-full h-16 bg-white border-b border-gray-200 md:h-20 dark:bg-dark-850 dark:border-dark-650">
            <div class="container relative flex items-center justify-between pr-6 grow md:justify-start">
                <!-- Mobile menu button skeleton -->
                <button v-cloak class="skeleton docs-mobile-menu-button flex items-center justify-center shrink-0 overflow-hidden dark:text-white focus:outline-none rounded-full w-10 h-10 ml-3.5 md:hidden"><svg xmlns="http://www.w3.org/2000/svg" class="mb-px shrink-0" width="24" height="24" viewBox="0 0 24 24" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor"><path d="M2 4h20v2H2zM2 11h20v2H2zM2 18h20v2H2z"></path></g></svg></button>
                <div v-cloak id="docs-sidebar-toggle"></div>
        
                <!-- Logo -->
                <div class="flex items-center justify-between h-full py-2 md:w-75">
                    <div class="flex items-center px-2 md:px-6">
                        <a id="docs-site-logo" href="../" class="flex items-center leading-snug text-2xl">
                            <span class="dark:text-white font-semibold line-clamp-1 md:line-clamp-2">Hostr</span>
                        </a><span class="hidden px-2 py-1 ml-4 text-sm font-semibold leading-none text-root-logo-label-text bg-root-logo-label-bg rounded-sm md:inline-block">Docs</span>
                    </div>
        
                    <span class="hidden h-8 border-r md:inline-block dark:border-dark-650"></span>
                </div>
        
                <div class="flex justify-between md:grow">
                    <!-- Top Nav -->
                    <nav class="hidden md:flex">
                        <ul class="flex flex-col mb-4 md:pl-16 md:mb-0 md:flex-row md:items-center">
                            
                        </ul>
                    </nav>
        
                    <!-- Header Right Skeleton -->
                    <div v-cloak class="flex justify-end grow skeleton">
        
                        <!-- Search input mock -->
                        <div class="relative hidden w-40 lg:block lg:max-w-sm lg:ml-auto">
                            <div class="absolute flex items-center justify-center h-full pl-3 dark:text-dark-300">
                                <svg xmlns="http://www.w3.org/2000/svg" class="icon-base" width="16" height="16" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation" style="margin-bottom: 1px;"><g fill="currentColor" ><path d="M21.71 20.29l-3.68-3.68A8.963 8.963 0 0020 11c0-4.96-4.04-9-9-9s-9 4.04-9 9 4.04 9 9 9c2.12 0 4.07-.74 5.61-1.97l3.68 3.68c.2.19.45.29.71.29s.51-.1.71-.29c.39-.39.39-1.03 0-1.42zM4 11c0-3.86 3.14-7 7-7s7 3.14 7 7c0 1.92-.78 3.66-2.04 4.93-.01.01-.02.01-.02.01-.01.01-.01.01-.01.02A6.98 6.98 0 0111 18c-3.86 0-7-3.14-7-7z" ></path></g></svg>
                            </div>
                            <input class="w-full h-10 placeholder-gray-400 transition-colors duration-200 ease-in bg-gray-200 border border-transparent rounded md:text-sm hover:bg-white hover:border-gray-300 focus:outline-none focus:bg-white focus:border-gray-500 dark:bg-dark-600 dark:border-dark-600 dark:placeholder-dark-400" style="padding: 0.625rem 0.75rem 0.625rem 2rem" type="text" placeholder="Search">
                        </div>
        
                        <!-- Mobile search button -->
                        <div class="flex items-center justify-center w-10 h-10 lg:hidden">
                            <svg xmlns="http://www.w3.org/2000/svg" class="shrink-0 icon-base" width="20" height="20" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor" ><path d="M21.71 20.29l-3.68-3.68A8.963 8.963 0 0020 11c0-4.96-4.04-9-9-9s-9 4.04-9 9 4.04 9 9 9c2.12 0 4.07-.74 5.61-1.97l3.68 3.68c.2.19.45.29.71.29s.51-.1.71-.29c.39-.39.39-1.03 0-1.42zM4 11c0-3.86 3.14-7 7-7s7 3.14 7 7c0 1.92-.78 3.66-2.04 4.93-.01.01-.02.01-.02.01-.01.01-.01.01-.01.02A6.98 6.98 0 0111 18c-3.86 0-7-3.14-7-7z" ></path></g></svg>
                        </div>
        
                        <!-- Dark mode switch placeholder -->
                        <div class="w-10 h-10 lg:ml-2"></div>
        
                        <!-- History button -->
                        <div class="flex items-center justify-center w-10 h-10" style="margin-right: -0.625rem;">
                            <svg xmlns="http://www.w3.org/2000/svg" class="shrink-0 icon-base" width="22" height="22" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor" ><g ><path d="M12.01 6.01c-.55 0-1 .45-1 1V12a1 1 0 00.4.8l3 2.22a.985.985 0 001.39-.2.996.996 0 00-.21-1.4l-2.6-1.92V7.01c.02-.55-.43-1-.98-1z"></path><path d="M12.01 1.91c-5.33 0-9.69 4.16-10.05 9.4l-.29-.26a.997.997 0 10-1.34 1.48l1.97 1.79c.19.17.43.26.67.26s.48-.09.67-.26l1.97-1.79a.997.997 0 10-1.34-1.48l-.31.28c.34-4.14 3.82-7.41 8.05-7.41 4.46 0 8.08 3.63 8.08 8.09s-3.63 8.08-8.08 8.08c-2.18 0-4.22-.85-5.75-2.4a.996.996 0 10-1.42 1.4 10.02 10.02 0 007.17 2.99c5.56 0 10.08-4.52 10.08-10.08.01-5.56-4.52-10.09-10.08-10.09z"></path></g></g></svg>
                        </div>
                    </div>
        
                    <div v-cloak class="flex justify-end grow">
                        <div id="docs-mobile-search-button"></div>
                        <doc-search-desktop></doc-search-desktop>
        
                        <doc-theme-switch class="lg:ml-2"></doc-theme-switch>
                        <doc-history></doc-history>
                    </div>
                </div>
            </div>
        </header>
    
        <div class="container relative flex bg-white">
            <!-- Sidebar Skeleton -->
            <div v-cloak class="fixed flex flex-col shrink-0 duration-300 ease-in-out bg-gray-100 border-gray-200 sidebar top-20 w-75 border-r h-screen md:sticky transition-transform skeleton dark:bg-dark-800 dark:border-dark-650">
            
                <!-- Render this div, if config.showSidebarFilter is `true` -->
                <div class="flex items-center h-16 px-6">
                    <input class="w-full h-8 px-3 py-2 transition-colors duration-200 ease-linear bg-white border border-gray-200 rounded shadow-none text-sm focus:outline-none focus:border-gray-600 dark:bg-dark-600 dark:border-dark-600" type="text" placeholder="Filter">
                </div>
            
                <div class="pl-6 mt-1 mb-4">
                    <div class="w-32 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-48 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-40 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-32 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-48 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-40 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                </div>
            
                <div class="shrink-0 mt-auto bg-transparent dark:border-dark-650">
                    <a class="flex items-center justify-center flex-nowrap h-16 text-gray-400 dark:text-dark-400 hover:text-gray-700 dark:hover:text-dark-300 transition-colors duration-150 ease-in docs-powered-by" target="_blank" href="https://retype.com/" rel="noopener">
                        <span class="text-xs whitespace-nowrap">Powered by</span>
                        <svg xmlns="http://www.w3.org/2000/svg" class="ml-2" fill="currentColor" width="96" height="20" overflow="visible"><path d="M0 0v20h13.59V0H0zm11.15 17.54H2.44V2.46h8.71v15.08zM15.8 20h2.44V4.67L15.8 2.22zM20.45 6.89V20h2.44V9.34z"/><g><path d="M40.16 8.44c0 1.49-.59 2.45-1.75 2.88l2.34 3.32h-2.53l-2.04-2.96h-1.43v2.96h-2.06V5.36h3.5c1.43 0 2.46.24 3.07.73s.9 1.27.9 2.35zm-2.48 1.1c.26-.23.38-.59.38-1.09 0-.5-.13-.84-.4-1.03s-.73-.28-1.39-.28h-1.54v2.75h1.5c.72 0 1.2-.12 1.45-.35zM51.56 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92h4.74v1.83h-6.79V5.36h6.64zM60.09 7.15v7.48h-2.06V7.15h-2.61V5.36h7.28v1.79h-2.61zM70.81 14.64h-2.06v-3.66l-3.19-5.61h2.23l1.99 3.45 1.99-3.45H74l-3.19 5.61v3.66zM83.99 6.19c.65.55.97 1.4.97 2.55s-.33 1.98-1 2.51-1.68.8-3.04.8h-1.23v2.59h-2.06V5.36h3.26c1.42 0 2.45.28 3.1.83zm-1.51 3.65c.25-.28.37-.69.37-1.22s-.16-.92-.48-1.14c-.32-.23-.82-.34-1.5-.34H79.7v3.12h1.38c.68 0 1.15-.14 1.4-.42zM95.85 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92H96v1.83h-6.79V5.36h6.64z"/></g></svg>
                    </a>
                </div>
            </div>
            
            <!-- Sidebar component -->
            <doc-sidebar v-cloak>
                <template #sidebar-footer>
                    <div class="shrink-0 mt-auto border-t md:bg-transparent md:border-none dark:border-dark-650">
            
                        <a class="flex items-center justify-center flex-nowrap h-16 text-gray-400 dark:text-dark-400 hover:text-gray-700 dark:hover:text-dark-300 transition-colors duration-150 ease-in docs-powered-by" target="_blank" href="https://retype.com/" rel="noopener">
                            <span class="text-xs whitespace-nowrap">Powered by</span>
                            <svg xmlns="http://www.w3.org/2000/svg" class="ml-2" fill="currentColor" width="96" height="20" overflow="visible"><path d="M0 0v20h13.59V0H0zm11.15 17.54H2.44V2.46h8.71v15.08zM15.8 20h2.44V4.67L15.8 2.22zM20.45 6.89V20h2.44V9.34z"/><g><path d="M40.16 8.44c0 1.49-.59 2.45-1.75 2.88l2.34 3.32h-2.53l-2.04-2.96h-1.43v2.96h-2.06V5.36h3.5c1.43 0 2.46.24 3.07.73s.9 1.27.9 2.35zm-2.48 1.1c.26-.23.38-.59.38-1.09 0-.5-.13-.84-.4-1.03s-.73-.28-1.39-.28h-1.54v2.75h1.5c.72 0 1.2-.12 1.45-.35zM51.56 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92h4.74v1.83h-6.79V5.36h6.64zM60.09 7.15v7.48h-2.06V7.15h-2.61V5.36h7.28v1.79h-2.61zM70.81 14.64h-2.06v-3.66l-3.19-5.61h2.23l1.99 3.45 1.99-3.45H74l-3.19 5.61v3.66zM83.99 6.19c.65.55.97 1.4.97 2.55s-.33 1.98-1 2.51-1.68.8-3.04.8h-1.23v2.59h-2.06V5.36h3.26c1.42 0 2.45.28 3.1.83zm-1.51 3.65c.25-.28.37-.69.37-1.22s-.16-.92-.48-1.14c-.32-.23-.82-.34-1.5-.34H79.7v3.12h1.38c.68 0 1.15-.14 1.4-.42zM95.85 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92H96v1.83h-6.79V5.36h6.64z"/></g></svg>
                        </a>
                    </div>
                </template>
            </doc-sidebar>
    
            <div class="grow min-w-0 dark:bg-dark-850">
                <!-- Render "toolbar" template here on api pages --><!-- Render page content -->
                <div class="flex">
                    <div class="min-w-0 p-4 grow md:px-16">
                        <main class="relative pb-12 lg:pt-2">
                            <div class="docs-markdown" id="docs-content">
                                <!-- Rendered if sidebar right is enabled -->
                                <div id="docs-sidebar-right-toggle"></div>
                                <!-- Page content  -->
<doc-anchor-target id="app" class="break-words">
    <h1>
        <doc-anchor-trigger class="header-anchor-trigger" to="#app">#</doc-anchor-trigger>
        <span>App</span>
    </h1>
</doc-anchor-target>
<p><figure class="content-center">
    <a href="https://codecov.io/gh/sudonym-btc/hostr">
        <img src="https://codecov.io/gh/sudonym-btc/hostr/branch/main/graph/badge.svg?token=YOUR_TOKEN" alt="codecov">
    </a>
    <figcaption class="caption">codecov</figcaption>
</figure>
</p>
<p>This is a client that displays and posts events related to short term accommodation lets over the nostr network.</p>
<doc-anchor-target id="getting-started">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#getting-started">#</doc-anchor-trigger>
        <span>Getting Started</span>
    </h2>
</doc-anchor-target>
<p>Install <a href="https://docs.flutter.dev/get-started/install">Flutter</a>
By default flutter launches in <code v-pre>mock</code> mode. It will not attempt to connect to relays or swap services. To connect to other environments, check the VSCode debug launcher.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">flutter run</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="structure">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#structure">#</doc-anchor-trigger>
        <span>Structure</span>
    </h2>
</doc-anchor-target>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">./lib
├── config            # Configs like default relays and EVM-RPC URLs
├── core              # Utils and mic
├── data
    ├── models        # Data models and mock data
    └── repositories  # Classes for fetching certain types of data
├── logic             # How data flows through app
├── presentation      # How data looks
└── README.md</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="nips-utilized">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#nips-utilized">#</doc-anchor-trigger>
        <span>NIPs Utilized</span>
    </h2>
</doc-anchor-target>
<ul>
<li><strong>NIP-01</strong>: Basic protocol for event creation and subscription.</li>
<li><strong>NIP-05</strong>: Mapping Nostr keys to DNS-based internet identifiers.</li>
<li><strong>NIP-09</strong>: Event deletion for removing listings or messages.</li>
<li><strong>NIP-17</strong>: Encrypted direct messages for secure communication between hosts and guests.</li>
<li><strong>NIP-33</strong>: Parameterized replaceable events for creating and updating listings and bookings.</li>
</ul>
<doc-anchor-target id="dependency-injection-and-mocking">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#dependency-injection-and-mocking">#</doc-anchor-trigger>
        <span>Dependency injection and mocking</span>
    </h2>
</doc-anchor-target>
<ul>
<li>Each <code v-pre>Screen</code> widget just handles the mapping of query and path parameters onto it&#x27;s corresponding <code v-pre>View</code> widget. This allows for catalogging widgets while only using their TypeSafe parameters, rather than having to pass in query strings etc.</li>
</ul>
<doc-anchor-target id="nostr-synchronization">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#nostr-synchronization">#</doc-anchor-trigger>
        <span>Nostr Synchronization</span>
    </h2>
</doc-anchor-target>
<doc-anchor-target id="hydrated-cubits">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#hydrated-cubits">#</doc-anchor-trigger>
        <span>Hydrated cubits</span>
    </h3>
</doc-anchor-target>
<p><a href="https://pub.dev/packages/hydrated_bloc">Hydrated</a> blocs are used to persist state between app relaunched, preventing re-sync upon every usage.
Hydrated blocs must be cleared on logout.</p>
<doc-anchor-target id="list-cubit">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#list-cubit">#</doc-anchor-trigger>
        <span>List cubit</span>
    </h3>
</doc-anchor-target>
<p>A list cubit listens to a filter and starts a subscription stream instance with a specific filter. Emitting from the filter cubit will trigger the list state to reset.
Use a postFilter cubit to emit a predicate that filters fetched results based on parameters that can&#x27;t be filtered for via Nostr requests directly.
A sort cubit determines how the results are ordered.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-dart"><code v-pre class="language-dart">class ListCubit&lt;NostrEvent&gt; {
  FilterCubit filter;
  PostResultFilterCubit postFilter;
  SortCubit sort;
}</code></pre>
</doc-codeblock></div>
<p>It has the following methods:</p>
<p><code v-pre>Load new</code></p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-dart"><code v-pre class="language-dart">startRequestAndCloseOnEOSE
{
  until: null,
  since: max(items.createdAt)
}</code></pre>
</doc-codeblock></div>
<p><code v-pre>Load next</code></p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-dart"><code v-pre class="language-dart">startRequestAndCloseOnEOSE
{
  until: min(items.createdAt),
  since: null
}</code></pre>
</doc-codeblock></div>
<p><code v-pre>Load all</code></p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-dart"><code v-pre class="language-dart">// Limit not required, will load all.
loadNew()

//If limit was imposed by the relay, try fetching next batch until nothing returnes
while(await loadNext()) do

emit(State.copyWith({status: Synching}))</code></pre>
</doc-codeblock></div>
<p>The class emits:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-dart"><code v-pre class="language-dart">Idle          // Used when not doing anything or listening
Listening     // Used when synched and awaiting new events
LoadingNext   // Used when fetching older events
Synching      // Used when loading next in a loop
Failed        // Used when all relays fail to respond correctly</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="messaging-cubit-hydrated">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#messaging-cubit-hydrated">#</doc-anchor-trigger>
        <span>Messaging cubit (Hydrated)</span>
    </h3>
</doc-anchor-target>
<p>The messaging cubit is responsible for loading and storing all <code v-pre>kind 14</code> private and encrypted DMs. Since messages include reservation offers made &amp; received, it&#x27;s vital that this stays up-to-date and is synched upon app login. Since private DMs are sent using a random pubkey for added privacy, it is not possible to search for messages from/to our OWN pubkey to load relevant messages. Nostr NIP <a href="https://github.com/nostr-protocol/nips/blob/master/17.md">17</a> recomemends giftwrapping the message and sending it from randomized keys to us and to the real receiver.</p>
<p>Before a user can interact in the inbox, the message stream must have received <code v-pre>EOSE</code> for all connected relays using filter</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-json"><code v-pre class="language-json">{
  kinds [1059],
  tags: [
    [&quot;p&quot;, userPubkey]
  ]
}</code></pre>
</doc-codeblock></div>
<p>This stream, when completed, will hold a state of all messages ever received.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-dart"><code v-pre class="language-dart">/// This list should stay in memory for the duration of a user sign in
class MessagingCubit extends ListCubit&lt;Message&gt; with HydratedMixin {
  kinds: [14],
  List&lt;ThreadCubit&gt; threads

  init() {
    items.listen((message) {
      addToThread(message)
    })
  }

  addToThread(NostrEvent message) {

  }
}
class MessagingCubitState {
  List&lt;ThreadCubit&gt;
}</code></pre>
</doc-codeblock></div>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-dart"><code v-pre class="language-dart">class ThreadCubit extends Cubit&lt;&gt; {

}</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="search">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#search">#</doc-anchor-trigger>
        <span>Search</span>
    </h3>
</doc-anchor-target>
<doc-anchor-target id="reservation-checker-cubit">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#reservation-checker-cubit">#</doc-anchor-trigger>
        <span>Reservation Checker Cubit</span>
    </h3>
</doc-anchor-target>
<p>The reservation checker cubit can listen to the search list results, and query corresponding reservations as needed.</p>
<p>For each search result which matches the postResultFilter filter we need to fetch reservations to check availability.
This is difficult, because one listing could have hundreds of reservations, or many listings could have no reservations.
In the first iteration, we can just query each listing individually.</p>
<p>We could potentially load multiple listing&#x27;s reservations using one <code v-pre>NostrFilter</code> by inputting multiple <code v-pre>d</code> tags.</p>
<p>For each result in our results list, we need to query all reservations as there is no way to filter based on date range.</p>
<p>Once each synch event fires, indicating that reservations have completely loaded for a set of listings, we need to update the search postResultFilter predicate to exclude those items, or reorder the list.</p>
<doc-anchor-target id="reviews">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#reviews">#</doc-anchor-trigger>
        <span>Reviews</span>
    </h3>
</doc-anchor-target>
<p>Reviews use Nostr kind 14. They can include tags such as tags: [[&#x27;cleanliness&#x27;, 1], [&#x27;checkIn&#x27;, 0.6]]. The content can be the comment that the guest wishes to leave.</p>
<p>The review event should include a tag with commitment pre-image, that only the owner of the reservation knows,</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-dart"><code v-pre class="language-dart">tags.append([&quot;e&quot;, liked.id])
tags.append([&quot;p&quot;, liked.pubkey])
tags.append([&quot;a&quot;, liked.tags[a]]),
tags.append([&quot;commit_preimage&quot;, reservation.reservation_request.preimage])
</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="payments">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#payments">#</doc-anchor-trigger>
        <span>Payments</span>
    </h2>
</doc-anchor-target>
<p>A payment can be either a Bolt11 invoice, Bolt12 offer, LNURL string, Lightning Address, Zap, or npub. Unless a fixed user-requested amount has already been set, the flow should be as follows:</p>
<div class="overflow-hidden mb-6 py-4 dark:px-5 dark:bg-white rounded-md"><pre class="mermaid w-full">flowchart TD

  Input[Payment Request
  to, amount?, needReceipt=true]

  subgraph Resolve Info

  A@{shape: diamond, label: &quot;Must resolve?&quot;}
  C@{shape: rectangle, label: &quot;Bolt11&quot;}
  B@{shape: rectangle, label: &quot;LNURL, Lightning Address, Bolt12, Zap, npub&quot;}
  A---|Yes|B
  A---|No|C
  D@{shape: rectangle, label: &quot;commentMax, commentMin, minAmount, maxAmount, callbackUrl&quot;}
  E@{shape: rectangle, label: &quot;fetch&quot;}
  B--&gt;E
  E--&gt;D
  C--&gt;D

  end

  Input--&gt;A

  D--&gt;FetchFinal[Fetch bolt11 and verify hash/amount]
  FetchFinal--&gt;PayMethod@{shape: diamond, label: &quot;NWC enabled?&quot;}
  PayMethod---|No|PayBolt11WithDeeplinkQR
  PayBolt11WithDeeplinkQR--&gt;ManuallyCloseAwaitZapEscrowEvent
  PayMethod---|Yes|NWCPayInvoice
  NWCPayInvoice--&gt;NWCResponse@{shape: diamond, label: &quot;notification received?&quot;}
  NWCResponse--&gt;CloseUI</pre></div>
<p>Payments requests, triggered by components in the app, should queue until they are next to be processed. Edge case.</p>
<doc-anchor-target id="payments-for-swaps">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#payments-for-swaps">#</doc-anchor-trigger>
        <span>Payments for swaps</span>
    </h3>
</doc-anchor-target>
<p>When we swap funds from lightning into EVM balance, the preimage from the swap invoice we paid is used to claw back the funds if something goes wrong. We also generate this preimage, so we must store this safely.</p>
<p>When we swap from EVM to lightning, we don&#x27;t need receipt from lightning that payment was made. As we can just reclaim our EVM balance after a timeout if it has not been claimed. Movement of the EVM funds indicate success or failure.</p>
<doc-anchor-target id="payments-manager--ephemeral">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#payments-manager--ephemeral">#</doc-anchor-trigger>
        <span>Payments Manager / Ephemeral</span>
    </h3>
</doc-anchor-target>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-dart"><code v-pre class="language-dart">class PaymentManager {
  List&lt;PaymentCubit&gt; payments = [];

  void initiatePayment(double amount) {
    var paymentCubit = PaymentCubit(amount);
    payments.add(paymentCubit);
    emit(paymentCubit)

    paymentCubit.stream.listen((paymentStatus) {
      if (paymentStatus is TerminalPaymentState) {
        payments.remove(paymentCubit);
      }
    });
  }
}</code></pre>
</doc-codeblock></div>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-dart"><code v-pre class="language-dart">class PaymentCubit extends Cubit&lt;String&gt; {
  final double amount;
  final String to;

  PaymentCubit(this.amount) : super('Initialized');

  void resolve()

  void confirm()

  void listenForResponse()
}</code></pre>
</doc-codeblock></div>
<p>Consume payment requests visually</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-dart"><code v-pre class="language-dart">// Listen to PaymentManager for new payments

BlocListener&lt;PaymentManager, PaymentCubit?&gt;(
  listener: (context, paymentCubit) {
    if (paymentCubit != null) {
      /// Trigger resolution of this payments details
      paymentCubit.resolve();
      /// Open payment modal
      openModal(paymentCubit);
    }
  }
)</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="swap-out-submarine-swap">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#swap-out-submarine-swap">#</doc-anchor-trigger>
        <span>Swap out (Submarine Swap)</span>
    </h2>
</doc-anchor-target>
<p>A swap-out occurs after an escrow has paid the seller out on the EVM chain.
The funds now need to be swept back to lightning.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-diff"><code v-pre class="language-diff">How can we get cought out?

- We lock our funds in the lock TXN and never refund ourselves

- We overpay fees</code></pre>
</doc-codeblock></div>
<div class="overflow-hidden mb-6 py-4 dark:px-5 dark:bg-white rounded-md"><pre class="mermaid w-full">flowchart TD
  SwapOut[Swap Out]
  --&gt;GetTotalBalance
  --&gt;SubtractFees
  --&gt;GenerateInvoice
  --&gt;ContactBoltz[Contact Boltz for submarine Swap. Params: invoice
  ]
  --&gt;SwapCreated[Returns:
  boltzClaimAddr, timeoutBlockHeight, expectedAmount]
  --&gt;LockEVMFunds
  --&gt;A@{shape: diamond, label: &quot;Did they unlock with preimage?&quot;}
  ---|No|RefundAfterTimelock
  A---|Yes|WeMustHaveBeenPaidOut</pre></div>
<doc-anchor-target id="swap-in-reverse-submarine-swap">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#swap-in-reverse-submarine-swap">#</doc-anchor-trigger>
        <span>Swap in (Reverse Submarine Swap)</span>
    </h2>
</doc-anchor-target>
<p>A swap-in (reverse submarine swap) only happens when we are bridging to an EVM layer for escrow services. Once we are swapped in, the keys of our app (AKA the nsec) is the key for spending the funds into the escrow, and sweeping funds out of escrow upon completion.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-diff"><code v-pre class="language-diff">How can we get cought out?

- We receive preimage from the paid invoice, but never claim our funds due to closed app

- Preimage that we require to claim the funds is lost
+ Allow input such that user can manually paste preimage if the payment notification event gets lost in nostr

- We pay an invoice without checking it's hash corresponds to preimage we generated

- We overpay fees

- We require relay to broadcast claim, since no EVM funds in claimerAddr on first swap-in</code></pre>
</doc-codeblock></div>
<div class="overflow-hidden mb-6 py-4 dark:px-5 dark:bg-white rounded-md"><pre class="mermaid w-full">flowchart TD
  SwapIn[Swap In
  amount, sweepToAddr]
  --&gt;ContactBoltz[Contact Boltz for Reverse Submarine Swap:amount, claimAddr, preimageHash]
  ContactBoltz--&gt;SwapDetails[Returns:
  amount, refundAddr, timelock, invoice]
  SwapDetails--&gt;PaymentFlow[Payment Flow
  to: invoice, receiptRequired:False, onCompleteOrClose: next]
  PaymentFlow--&gt;ListenForLockTxnConfirm
  ListenForLockTxnConfirm--&gt;ClaimFunds
  ClaimFunds</pre></div>
<doc-anchor-target id="escrow">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#escrow">#</doc-anchor-trigger>
        <span>Escrow</span>
    </h2>
</doc-anchor-target>
<p>We deposit using our EVM balance.</p>
<div class="overflow-hidden mb-6 py-4 dark:px-5 dark:bg-white rounded-md"><pre class="mermaid w-full">flowchart TD
    PayEscrow[Pay Escrow
  amount, escrowPubkey, counterpartyPubkey]
  --&gt; CalculateFees
  --&gt; GenerateEscrow[GenerateEscrowContract,
    amount, escrowPubkey, counterpartyPubkey]
  --&gt; SwapIn[Swap In with params:
    amountPlusFees, claimAddr, onComplete: next]
  --&gt; FundEscrow(GenerateEscrowContract.id, amount, )
</pre></div>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">class EscrowDepositManager extends Cubit&lt;Map&lt;String, dynamic&gt;&gt; {
  final SwapManager swapManager;
  final RpcClient rpcClient;
  Map&lt;String, dynamic&gt; pendingDeposits = {};

  EscrowDepositManager(this.swapManager, this.rpcClient) : super({});

  void initiateEscrowDeposit(double amount, String escrowPubkey, String counterpartyPubkey) {
    final depositId = DateTime.now().millisecondsSinceEpoch.toString();
    pendingDeposits[depositId] = {
      'amount': amount,
      'escrowPubkey': escrowPubkey,
      'counterpartyPubkey': counterpartyPubkey,
      'status': 'initiated'
    };
    emit(pendingDeposits);

    swapManager.swapIn(amount);
    swapManager.stream.listen((swapStatus) {
      if (swapStatus == 'Completed') {
        _completeEscrowDeposit(depositId);
      }
    });
  }

  void _completeEscrowDeposit(String depositId) {
    final deposit = pendingDeposits[depositId];
    if (deposit != null) {
      final amount = deposit['amount'];
      final escrowPubkey = deposit['escrowPubkey'];
      final counterpartyPubkey = deposit['counterpartyPubkey'];

      // Create and broadcast the escrow transaction
      rpcClient.createEscrowTransaction(amount, escrowPubkey, counterpartyPubkey).then((txHash) {
        deposit['status'] = 'completed';
        deposit['txHash'] = txHash;
        emit(pendingDeposits);
      }).catchError((error) {
        deposit['status'] = 'failed';
        emit(pendingDeposits);
      });
    }
  }

  void resumePendingDeposits() {
    pendingDeposits.forEach((depositId, deposit) {
      if (deposit['status'] == 'initiated') {
        swapManager.swapIn(deposit['amount']);
        swapManager.stream.listen((swapStatus) {
          if (swapStatus == 'Completed') {
            _completeEscrowDeposit(depositId);
          }
        });
      }
    });
  }</code></pre>
</doc-codeblock></div>
<div class="overflow-hidden mb-6 py-4 dark:px-5 dark:bg-white rounded-md"><pre class="mermaid w-full">flowchart TD
  A[Escrow Deposit Initiated] --&gt; B[Show Escrow Profile]
  B --&gt; C[Show Listing Info Widget]
  C --&gt; D[Show Profile of Seller]
  D --&gt; E[Show Pricing + Fees]
  E --&gt; F{Buyer OK's This?}
  F -- Yes --&gt; G[Initiate Swap In]
  G --&gt; H[Initiate Lightning Payment]
  H --&gt; I{Swap Completed or Failed?}
  I -- Completed --&gt; J[Open Escrow-Deposit Modal]
  I -- Failed --&gt; K[Handle Swap Failure]
  J --&gt; L[Wait for Escrow Transaction Confirmation]
  L --&gt; M[Escrow Deposit Completed]</pre></div>
<doc-anchor-target id="swap-manager-hydrated">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#swap-manager-hydrated">#</doc-anchor-trigger>
        <span>Swap Manager (Hydrated)</span>
    </h2>
</doc-anchor-target>
<p>The swap manager is a global service that can run independently from UI (may need to be run in <a href="https://pub.dev/packages/flutter_background_service">background</a>) when possible.</p>
<p>Swap manager should be a hydrated cubit, such that it remembers the latest scanned part of the chain.</p>
<ul>
<li>We need to make sure that if two instances of swap manager are running, they do not broadcast competing transactions. If they deterministically create the same transactions, should these be rejected by network and don&#x27;t risk double-paying fees?</li>
</ul>
<div class="overflow-hidden mb-6 py-4 dark:px-5 dark:bg-white rounded-md"><pre class="mermaid w-full">classDiagram
    class SwapManager {
        -String privateKey
        -List&lt;String&gt; lockInPreimagesFromMemory
        -RpcClient rpcClient
        -PaymentsCubit paymentsCubit
        +initialize()
        +scanChain()
        +initializeSwaps()
        +swapIn(double amount)
        +swapOut(double amount)
    }

    class SwapCubit {
        +id // identifies the swap uniquely pre-image hash or EVM txId
        +emitInFlight()
        +emitCompleted()
        +emitFailed()
    }

    class SwapInCubit {
        +emitClaiming()
    }

    class SwapOutCubit {
        +emitRefunding()
        +emitRefunded()
    }

    class PaymentsCubit {
        +initiatePayment(double amount)
    }

    SwapManager --&gt; SwapCubit
    SwapManager --&gt; PaymentsCubit
    SwapCubit &lt;|-- SwapInCubit
    SwapCubit &lt;|-- SwapOutCubit</pre></div>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-dart"><code v-pre class="language-dart">import 'package:flutter_bloc/flutter_bloc.dart';
import 'payment_cubit.dart';

class SwapManager extends Cubit&lt;String&gt; {
  String privateKey;
  List&lt;String&gt; lockInPreimagesFromMemory;
  RpcClient rpcClient;
  List&lt;SwapCubit&gt; swaps = [];
  PaymentsCubit paymentsCubit;

  SwapManager(this.privateKey, this.lockInPreimagesFromMemory, this.rpcClient, this.paymentsCubit) : super('Initialized') {
    paymentsCubit.stream.listen((paymentStatus) {
      // Handle payment status updates
    });
  }

  void initialize() {
    scanChain();
    initializeSwaps();
  }

  void scanChain() {
    // Logic to scan the EVM chain for pending swaps
    // Populate the swaps list with SwapInCubit or SwapOutCubit instances
  }

  void initializeSwaps() {
    for (var swap in swaps) {
      swap.checkStatus();
    }
  }

  void swapIn(double amount) {
    var swapInCubit = SwapInCubit();
    swaps.add(swapInCubit);
    emit('InFlight');
    paymentsCubit.initiatePayment(amount);
    paymentsCubit.stream.listen((paymentStatus) {
      if (paymentStatus == 'Completed') {
        swapInCubit.emitCompleted();
        emit('Completed');
      } else if (paymentStatus == 'Failed') {
        swapInCubit.emitFailed();
        emit('Failed');
      }
    });
  }

  void swapOut(double amount) {
    var swapOutCubit = SwapOutCubit();
    swaps.add(swapOutCubit);
    emit('InFlight');
    // Additional logic for swap out
  }
}</code></pre>
</doc-codeblock></div>
<p>The swap manager might then be consumed like this</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-dart"><code v-pre class="language-dart">@override
Widget build(BuildContext context) {
  return MultiBlocProvider(
    providers: [
      BlocProvider&lt;SwapManager&gt;(
        create: (context) =&gt; swapManager,
      ),
      ...swapManager.swaps.map((swap) =&gt; BlocProvider.value(value: swap)),
    ],
    child: MaterialApp(
      home: SwapListScreen(),
    ),
  );
}</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="ui">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#ui">#</doc-anchor-trigger>
        <span>UI</span>
    </h2>
</doc-anchor-target>
<doc-anchor-target id="shared">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#shared">#</doc-anchor-trigger>
        <span>Shared</span>
    </h3>
</doc-anchor-target>
<ul>
<li><strong>Profile page</strong>
<ul>
<li>Image, name, description, NIP05, Zap button</li>
<li><strong>Edit page</strong></li>
</ul>
</li>
<li><strong>Listing page</strong>
<ul>
<li>Reviews and ratings, reservations, description, pricing</li>
<li>If guest mode:
<ul>
<li>Calendar preloaded with unavailable dates</li>
<li>Reserve button only active once all reservations are fetched and validated</li>
</ul>
</li>
<li>If host mode:
<ul>
<li>Show calendar by default</li>
<li><code v-pre>Reservation</code> can be made instantly and for zero cost to block dates</li>
</ul>
</li>
<li><strong>Edit page</strong></li>
</ul>
</li>
<li><strong>Wallet Page</strong>
<ul>
<li>Shows current wallet connection, allows user to reconnect if required</li>
<li>List of current in-flight payments</li>
<li>List of trusted escrow providers</li>
</ul>
</li>
<li><strong>Messaging page</strong>
<ul>
<li>Shows list of messages grouped by <code v-pre>pubkey:a</code>, identifies the conversation by user and reservation request anchor</li>
<li>List item
<ul>
<li>Counterparty name and avatar</li>
<li>Text of incoming or outgoing message, replaced with italic text if:
<ul>
<li>Last message was a reservation request: &#x27;Alex requested a 2 night stay&#x27;</li>
<li>Look for <code v-pre>reservation</code> with commit_hash of <code v-pre>reservation request</code>, if exists, add &quot;booking confirmed&quot; icon to chat.</li>
</ul>
</li>
</ul>
</li>
<li>Conversation page
<ul>
<li>Header
<ul>
<li>If host
<ul>
<li>Attempt to fetch zaps to prove payment</li>
<li>Attempt to use lookup_invoice to check if invoices attached to reservation_requests have been paid</li>
<li>Attempt to use EVM to check if money in lockup</li>
</ul>
</li>
<li>Show profile of counterparty
<ul>
<li>Fetch <code v-pre>reservation</code> which references the anchor of this conversation.
<ul>
<li>If stay is in future: &quot;Alex is booked to be hosted by you Jan 3 - Jan 6&quot;</li>
</ul>
</li>
<li>If null, fetch most recent <code v-pre>reservation_request</code> of this conversation anchor. &quot;Alex has requested to stay 3 night, Jan 3 - 6, for 60k sats&quot; or &quot;You offered to host Alex for 3 nights, Jan 3- 6, for 60k sats&quot; Accept (Change) - can change price if allowBarter is true, can change dates if counterparty is host.
<ul>
<li>Host
<ul>
<li>Accept
<ul>
<li>Require upfront payment?</li>
<li>Can generate expiring invoice? Attach to listing</li>
<li>Don&#x27;t require upfront payment? Sends back signed reservation with commit_hash of buyers request</li>
</ul>
</li>
<li><em>Can use NWC to generate expiring invoice</em>.</li>
<li>Change</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Fetches each message in the conversation and unwraps/parses if necessary</li>
<li>Combines with <code v-pre>reservation</code> list cubit where tag <code v-pre>commit_hash</code> is equal to first messages <code v-pre>commit_hash</code> tag</li>
<li>For each item in the conversation
<ul>
<li>If of reservation type:
<ul>
<li>Show &quot;booking confirmed&quot; widget.</li>
</ul>
</li>
<li>If of message type:
<ul>
<li>If wraps a reservation request display the offer widget</li>
<li>Else display the message plaintext</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<doc-anchor-target id="improvements">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#improvements">#</doc-anchor-trigger>
        <span>Improvements</span>
    </h2>
</doc-anchor-target>
<ul>
<li>Swap in transaction should go straight into the contract</li>
<li>Escrow contract COULD encode bolt12, and then escrcow can do the swap by proving they paid a corresponding bolt11 invoice and releasing the funds to themselves. Out of scope.</li>
</ul>
<doc-anchor-target id="assets">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#assets">#</doc-anchor-trigger>
        <span>Assets</span>
    </h2>
</doc-anchor-target>
<p>The <code v-pre>assets</code> directory houses images, fonts, and any other files you want to
include with your application.</p>
<p>The <code v-pre>assets/images</code> directory contains <a href="https://flutter.dev/docs/development/ui/assets-and-images#resolution-aware">resolution-aware
images</a>.</p>
<doc-anchor-target id="localization">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#localization">#</doc-anchor-trigger>
        <span>Localization</span>
    </h2>
</doc-anchor-target>
<p>This project generates localized messages based on arb files found in
the <code v-pre>lib/_localization</code> directory.</p>
<p>To support additional languages, please visit the tutorial on
<a href="https://flutter.dev/docs/development/accessibility-and-localization/internationalization">Internationalizing Flutter
apps</a></p>
<doc-anchor-target id="seed-relay">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#seed-relay">#</doc-anchor-trigger>
        <span>Seed relay</span>
    </h2>
</doc-anchor-target>
<!-- TODO export the JSON as a file such that it can be loaded straight into the relay from the docker-up command -->
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">flutter run lib/data/mock/seed_relay.dart</code></pre>
</doc-codeblock></div>

                                
                                <!-- Required only on API pages -->
                                <doc-toolbar-member-filter-no-results></doc-toolbar-member-filter-no-results>
                            </div>
                            <footer class="clear-both">
                            
                                <nav class="flex mt-14">
                                    <div class="w-1/2">
                                        <a class="px-5 py-4 h-full flex items-center break-normal font-medium text-blue-500 dark:text-blue-400 border border-gray-300 hover:border-gray-400 dark:border-dark-650 dark:hover:border-dark-450 rounded-l-lg transition-colors duration-150 relative hover:z-5" href="../">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="mr-3" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" overflow="visible"><path d="M19 11H7.41l5.29-5.29a.996.996 0 10-1.41-1.41l-7 7a1 1 0 000 1.42l7 7a1.024 1.024 0 001.42-.01.996.996 0 000-1.41L7.41 13H19c.55 0 1-.45 1-1s-.45-1-1-1z" /><path fill="none" d="M0 0h24v24H0z" /></svg>
                                            <span>
                                                <span class="block text-xs font-normal text-gray-400 dark:text-dark-400">Previous</span>
                                                <span class="block mt-1"> Hostr</span>
                                            </span>
                                        </a>
                                    </div>
                            
                                    <div class="w-1/2">
                                        <a class="px-5 py-4 -mx-px h-full flex items-center justify-end break-normal font-medium text-blue-500 dark:text-blue-400 border border-gray-300 hover:border-gray-400 dark:border-dark-650 dark:hover:border-dark-450 rounded-r-lg transition-colors duration-150 relative hover:z-5" href="../infrastructure/">
                                            <span>
                                                <span class="block text-xs font-normal text-right text-gray-400 dark:text-dark-400">Next</span>
                                                <span class="block mt-1">Infrastructure</span>
                                            </span>
                                            <svg xmlns="http://www.w3.org/2000/svg" class="ml-3" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" overflow="visible"><path d="M19.92 12.38a1 1 0 00-.22-1.09l-7-7a.996.996 0 10-1.41 1.41l5.3 5.3H5c-.55 0-1 .45-1 1s.45 1 1 1h11.59l-5.29 5.29a.996.996 0 000 1.41c.19.2.44.3.7.3s.51-.1.71-.29l7-7c.09-.09.16-.21.21-.33z" /><path fill="none" d="M0 0h24v24H0z" /></svg>
                                        </a>
                                    </div>
                                </nav>
                            </footer>
                        </main>
                
                        <div class="border-t dark:border-dark-650 pt-6 mb-8">
                            <footer class="flex flex-wrap items-center justify-between">
                                <div>
                                    <ul class="flex flex-wrap items-center text-sm">
                                    </ul>
                                </div>
                                <div class="docs-copyright py-2 text-gray-500 dark:text-dark-350 text-sm leading-relaxed"></div>
                            </footer>
                        </div>
                    </div>
                
                    <!-- Rendered if sidebar right is enabled -->
                    <!-- Sidebar right skeleton-->
                    <div v-cloak class="fixed top-0 bottom-0 right-0 translate-x-full bg-white border-gray-200 lg:sticky lg:border-l lg:shrink-0 lg:pt-6 lg:transform-none sm:w-1/2 lg:w-64 lg:z-0 md:w-104 sidebar-right skeleton dark:bg-dark-850 dark:border-dark-650">
                        <div class="pl-5">
                            <div class="w-32 h-3 mb-4 bg-gray-200 dark:bg-dark-600 rounded-full loading"></div>
                            <div class="w-48 h-3 mb-4 bg-gray-200 dark:bg-dark-600 rounded-full loading"></div>
                            <div class="w-40 h-3 mb-4 bg-gray-200 dark:bg-dark-600 rounded-full loading"></div>
                        </div>
                    </div>
                
                    <!-- User should be able to hide sidebar right -->
                    <doc-sidebar-right v-cloak></doc-sidebar-right>
                </div>

            </div>
        </div>
    
        <doc-search-mobile></doc-search-mobile>
        <doc-back-to-top></doc-back-to-top>
    </div>


    <div id="docs-overlay-target"></div>

    <script data-cfasync="false">window.__DOCS__ = { "title": "App", level: 1, icon: "file", hasPrism: true, hasMermaid: true, hasMath: false, tocDepth: 23 }</script>
</body>
</html>
